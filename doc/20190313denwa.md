# 2019/03/13 Pythonによる自動電話応対プログラム

自動電話応対プログラムの製作を通して、プログラミング言語Pythonへの理解を深めましょう。

## 入門編

Python特有の機能の前に、プログラミング一般に通じる要素を理解しましょう。

### プログラミング？

コンピュータは人の持っていない強大な力を秘めており、しかも従順ですが、人語を解しません。このコンピュータという従者に対して命令を与える呪文を書くことを**プログラミング**と呼びます。

**プログラミング言語**とはコンピュータに命令を伝えるための言語です。その種類は多種多様で、

- 書くのが難しいけどコンピュータの処理が早くなるもの
- 遅いけど簡単に書けるもの
- 特定の命令を書きやすいもの

などが用途に応じて使い分けられます。Pythonは遅いけど書きやすいタイプです。

### 今回はなんのためにプログラミングする？

「**自動電話応対**」です。

事務所にいると電話がかかってきます。これに応対する度に作業が中断されると作業がはかどりません。そこでコンピュータに応対させることを考えます。

<div style="page-break-before:always"></div>

### まず準備

Pythonでプログラミングをする準備をします。現状、理解したり覚えたりする必要はありません。コピペしましょう。

1. PowerShellを起動します。
    - 「スタート」を押して、「powershell」と入力すると出てくるはず。
1. Scoopをインストールします。PowerShellに以下を入力してEnterを押してください。
    ```
    iex (new-object net.webclient).downloadstring('https://get.scoop.sh')
    ```
    - これを使うことでソフトウェアをコマンド一発でインストール／アンインストールすることができます。
    - 参考: [lukesampson/scoop: A command-line installer for Windows.](https://github.com/lukesampson/scoop)
    - 参考: [So What? · lukesampson/scoop Wiki](https://github.com/lukesampson/scoop/wiki/So-What%3F)
1. Pythonをインストールします。
    ```
    scoop install python
    ```
    - Python言語のデータをダウンロードし、コンピュータに覚えさせます。
1. Sublime Textをインストールします。
    ```
    scoop bucket add extras
    scoop install sublime-text
    ```
    - 高機能な「メモ帳.exe」みたいなもの。命令書を書きやすくするための機能がつけられています。
1. Sublime Textの設定をします。
    - `Preference`→ TODO を開いて以下の文字をコピペします。
    ```
    TODO
    ```
1. `Cドライブ`→`Users`→`ユーザ名`→`Documents`に今回の課題用のフォルダを作ります。TODO
    ```
    cd
    mkdir
    cd
    ```

<div style="page-break-before:always"></div>

### プログラムを書いて命令を実行させましょう

1. Sublime Textを開いて(スタートを押して「sublime」と入力すれば出ます)、以下の命令文を入力します。
    ```
    # coding:utf-8
    print('お電話ありがとうございます。')
    print('申し訳ありませんが、現在間に合っております。')
    print('失礼いたします。')
    ```
    - `# coding:utf-8`は日本語を使うことをコンピュータに知らせる部分です。これを書かずにファイルに日本語を含めるとエラーが出ます。
1. `Cドライブ`→`Users`→`ユーザ名`→`Documents`→`seminar20190313`に`main.py`という名前で保存します。
    - `File`→`Save As` TODO
    - Pythonのプログラムファイルは`〜.py`という名前で保存します。
    - `main.py`じゃなくても`piyopiyo.py`とか好きな名前でもプログラムは実行できます。
1. `main.py`を実行します。PowerShellに以下を入力してEnter。
    ```
    python main.py
    ```

PowerShellに

```
お電話ありがとうございます。
申し訳ありませんが、現在間に合っております。
失礼いたします。
```

と出力されれば成功です。ここでわかるのは

- **`print('何か文字')`と書くと文字が表示される**
- **命令文は1行ずつ上から順番に実行する**

ということです。

### 複雑な命令を実行してみましょう

もちろん、Pythonには`print`を1行ずつ実行させる以外の機能もあります。最初から暗記する必要はありません。なんとなく意味がわかったら先へ進みましょう。

#### コメント

`#`をつけるとそれ以降の文字はプログラムとして扱われなくなります。プログラムの説明を書くときなどに使います。

```
# coding:utf-8
# お別れの挨拶
print('失礼致します。')
```

#### 演算子

**演算子**は足し算や引き算のような演算を表す記号のことです。色々な種類がありますが、まずは足し算だけ。

```
# coding:utf-8
print(21+34) #数字の足し算。56が出力されます
print('ハロー'+'ワーク') #文字列の足し算。ハローワークと出力されます。
```

#### 変数

**変数**は数字や文字を入れておく箱です。変数を使うことで、中身が決まっていないうちに箱の中身の操作を指定することができます。

```
# coding:utf-8
company = 'ハローワーク'
print('お世話になっております。'+company+'様でございますね')
```

#### 入力を受け取る

PowerShellで入力された文字列をプログラムの中で受け取ることができます。

```
# coding:utf-8
company = input()
print('お世話になっております。'+company+'様でございますね')
```

#### 条件分岐

条件によって行う処理を変えることができます。`==`は演算子の一種で、演算子の左右が同じものかどうかを判定します。

```
# coding:utf-8
company = input()
if company == '聞こえなかった':
  print('切る')
else if company == 'ハローワーク':
  print('受け付ける')
else:
  print('お断りする')
```

Pythonでは行頭のスペースを使って命令文の塊を表現します。スペースもきちんと入力しないとエラーになるので注意。

#### ループ

繰り返し同じ処理を行います。例の`while`ループでは繰り返し行う処理のはじめに、繰り返すかどうかの判定をします。

```
# coding:utf-8
company = 'ハローワーク'
while(company == 'ハローワーク'):
  print('ハローワークだった')
  company = input()
print('ハローワークじゃない！？！？！？！？')
```

`if`と同様、スペースを使うことで繰り返す部分を表現しています。

<div style="page-break-before:always"></div>

### 自動電話応対プログラムを作りましょう

ここまでで使った命令方法を踏まえ、自動電話応対プログラムをどのように作るか検討しましょう。ここではひとまず**電話がハローワークからなら全て社長へ投げ、それ以外からなら全てをお断りする**プログラムを作ります。

PowerShellで入力される文字列は

- ハローワーク
- マイナビ転職
- TODO スパム営業

の3通り。出力する文字列は

- 大変申し訳ございませんが、現在間に合っております。
- 担当の者へお取り次ぎいたします。少々お待ちください。

の2通り。

フローチャートを書くと以下のようになります。

TODO フローチャート

